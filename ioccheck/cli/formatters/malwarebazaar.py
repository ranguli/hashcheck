#!/usr/bin/env python
"""Module provides human-friendly output from the MalwareBazaar Service"""

import logging

from hurry.filesize import size
from tabulate import tabulate
from termcolor import colored

from ioccheck.cli.formatters.formatter import Formatter
from ioccheck.services import MalwareBazaar

logger = logging.getLogger(__name__)

f_handler = logging.FileHandler("ioccheck.log")
f_handler.setLevel(logging.INFO)

f_format = logging.Formatter("%(asctime)s - %(name)s - %(levelname)s - %(message)s")
f_handler.setFormatter(f_format)

logger.addHandler(f_handler)


class MalwareBazaarFormatter(Formatter):
    """Provide pre-formatted output from the MalwareBazaar Service"""
    service_heading = "MalwareBazaar"

    def __init__(self, service: MalwareBazaar, heading_color: str):
        Formatter.__init__(self, service, heading_color)

    @property
    def file_info(self):
        """Pre-formatted output for sample file size"""
        heading = colored(f"[*] {self.service_heading} file details:", self.heading_color)
        return f"{heading} .{self.service.file_type} | {self.service.mime_type} ({size(self.service.file_size)})"
