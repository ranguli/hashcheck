import pytest

from ioccheck.cli.formatters import MalwareBazaarFormatter


@pytest.fixture
def malwarebazaar_formatter(malwarebazaar_report_1):
    return MalwareBazaarFormatter(malwarebazaar_report_1.reports.malwarebazaar)


class TestMalwareBazaarFormatter:
    def test_exists(self, malwarebazaar_formatter):
        assert malwarebazaar_formatter

    def test_tags(self, malwarebazaar_formatter):
        assert malwarebazaar_formatter.tags == "exe, Loki"

    def test_file_size(self, malwarebazaar_formatter):
        assert malwarebazaar_formatter.file_size == "154K"

    def test_file_type(self, malwarebazaar_formatter):
        assert malwarebazaar_formatter.file_type == ".exe"
