import pytest


class TestMalwareBazaar:
    def test_exists(self, malwarebazaar_report_1):
        assert malwarebazaar_report_1

    def test_investigation_url(self, malwarebazaar_report_1):
        assert (
            malwarebazaar_report_1.reports.malwarebazaar.investigation_url
            == "https://bazaar.abuse.ch/sample/73bef2ac39be261ae9a06076302c1d0af982e0560e88ac168980fab6ea5dd9c4/"
        )

    def test_tags(self, malwarebazaar_report_1):
        assert malwarebazaar_report_1.reports.malwarebazaar.tags == ["exe", "Loki"]

    def test_signature(self, malwarebazaar_report_1):
        assert malwarebazaar_report_1.reports.malwarebazaar.signature == "Loki"

    def test_file_size(self, malwarebazaar_report_1):
        assert malwarebazaar_report_1.reports.malwarebazaar.file_size == 157777

    def test_file_type(self, malwarebazaar_report_1):
        assert malwarebazaar_report_1.reports.malwarebazaar.file_type == "exe"

    def test_mime_type(self, malwarebazaar_report_1):
        assert (
            malwarebazaar_report_1.reports.malwarebazaar.mime_type
            == "application/x-dosexec"
        )

    def hash_not_found(self, malwarebazaar_report_2):
        assert malwarebazaar_report_1.reports.malwarebazaar

    def other_hash_not_found(self, malwarebazaar_report_2):
        assert not malwarebazaar_report_1.reports.malwarebazaar.hashes.get(
            "sha256_hash"
        )
